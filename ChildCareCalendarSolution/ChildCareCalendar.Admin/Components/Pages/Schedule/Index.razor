@page "/schedules"

<div class="calendar" id="calendar">
	<div class="calendar-header">
		<button id="prevMonth">&lt;</button>
		<div id="monthYear"></div>
		<button id="nextMonth">&gt;</button>
	</div>
	<div class="calendar-body" id="calendarBody">
	</div>
</div>

<script>
	const dayNames = ["CN", "T2", "T3", "T4", "T5", "T6", "T7"];

	const appointments = [
		{ date: new Date(2025, 2, 10), subject: "Họp nhóm" },
		{ date: new Date(2025, 2, 15), subject: "Khám bác sĩ" },
		{ date: new Date(2025, 2, 15), subject: "Sinh nhật" }
	];

	let currentDate = new Date();

	function renderCalendar(date) {
		const monthYear = document.getElementById("monthYear");
		const calendarBody = document.getElementById("calendarBody");
		calendarBody.innerHTML = ""; 

		const options = { month: "long", year: "numeric" };
		monthYear.textContent = date.toLocaleDateString("vi-VN", options);

		dayNames.forEach(day => {
			const dayNameElem = document.createElement("div");
			dayNameElem.className = "day-name";
			dayNameElem.textContent = day;
			calendarBody.appendChild(dayNameElem);
		});

		const year = date.getFullYear();
		const month = date.getMonth();
		const firstDay = new Date(year, month, 1);
		const startingDay = firstDay.getDay();
		const daysInMonth = new Date(year, month + 1, 0).getDate();

		let cellCount = startingDay + daysInMonth;
		for (let i = 0; i < cellCount; i++) {
			const cell = document.createElement("div");
			cell.className = "day";
			if (i >= startingDay) {
				const dayNum = i - startingDay + 1;
				cell.textContent = dayNum;

				const cellDate = new Date(year, month, dayNum);
				const dayAppointments = appointments.filter(app => {
					return app.date.toDateString() === cellDate.toDateString();
				});
				if (dayAppointments.length > 0) {
					const appointElem = document.createElement("div");
					appointElem.className = "appointment";
					appointElem.textContent = dayAppointments.map(a => a.subject).join(", ");
					cell.appendChild(appointElem);
				}
			}
			calendarBody.appendChild(cell);
		}
	}

	document.getElementById("prevMonth").addEventListener("click", () => {
		currentDate.setMonth(currentDate.getMonth() - 1);
		renderCalendar(currentDate);
	});
	document.getElementById("nextMonth").addEventListener("click", () => {
		currentDate.setMonth(currentDate.getMonth() + 1);
		renderCalendar(currentDate);
	});

	renderCalendar(currentDate);
</script>